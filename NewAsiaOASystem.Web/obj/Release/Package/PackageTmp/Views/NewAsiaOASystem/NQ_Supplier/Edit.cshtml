@model NewAsiaOASystem.ViewModel.NQ_SupplierView
@{
    ViewBag.Title = "Edit";
    Layout = "~/Views/Shared/_SysLayout.cshtml";
}

@using (Html.BeginForm("updateSupplierAndAttachment", "NQ_Supplier", FormMethod.Post, new { id = "form1" }))
{

    @Html.HiddenFor(m => m.FItemID)
    <div class="infor">
        <p id="Ptitle"></p>
        <div class="system-menu-set">
            <ul class="infor-c">
                <li>
                    <span class="infor-c-width">供应商代码：</span>
                    @*<span class="infor-c-input">@Html.TextBoxFor(m => m.FNumber, new { disabled = "disabled" })</span>*@
                    <span class="infor-c-input">@Html.TextBox("FNumber", Model.FNumber, new { disabled = "disabled" })</span>
                </li>
                <li>
                    <span class="infor-c-width">供应商名称：</span>
                    <span class="infor-c-input">
                        @Html.TextBoxFor(m => m.FName, new { disabled = "disabled" })
                    </span>
                </li>
                <li>
                    <span class="infor-c-width">地址：</span>
                    <span class="infor-c-input">@Html.TextBoxFor(m => m.FAddress, new { disabled = "disabled" })</span>
                </li>
            </ul>
            <ul class="infor-c">
                <li>
                    <span class="infor-c-width">联系人：</span>
                    <span class="infor-c-input">@Html.TextBoxFor(m => m.FContact, new { disabled = "disabled" })</span>
                </li>
                <li>
                    <span class="infor-c-width">电话：</span>
                    <span class="infor-c-input">
                        @Html.TextBoxFor(m => m.FPhone, new { disabled = "disabled" })
                    </span>
                </li>
                <li>
                    <span class="infor-c-width">手机号：</span>
                    <span class="infor-c-input">
                        @Html.TextBoxFor(m => m.FMobilePhone, new { disabled = "disabled" })
                    </span>
                </li>
            </ul>
            <ul class="infor-c ">
                <li>
                    <span class="infor-c-width">供应商性质：</span>
                    <span class="infor-c-input">
                        @Html.RadioButtonFor(m => m.FSupplierType, 0, new { @id = "typeFactory", @name = "FSupplierType", @checked = "true", @onclick = "rdbSelected()" }) 厂家
                        @Html.RadioButtonFor(m => m.FSupplierType, 1, new { @id = "typeAgent", @name = "FSupplierType", @onclick = "rdbSelected()" }) 供应商

                    </span>
                </li>
            </ul>
            <ul class="infor-c ">
                <li>
                    @*<span style="float: left; color: red; font-size: 24px;vertical-align: middle; display: block; margin-left: 8px;width: 1px;">*</span>*@
                    <span class="infor-c-width">营业执照：<span style="color: red; font-size: 24px;vertical-align: middle; margin-left: 8px;width: 4px;">*</span></span>
                    <span class="infor-c-input">
                        @Html.TextBoxFor(m => m.FLicence, new { disabled = "disabled" })
                    </span>
                </li>
                <li>
                    <span class="infor-c-width">有效期至：</span>
                    <span class="infor-c-input">
                        <input type="text" name="FLicenceDeadline" value="@(ViewBag.FLicenceDeadline == null ? "":ViewBag.FLicenceDeadline.ToString("D") )" disabled="disabled" />
                    </span>
                </li>
                <li>
                    <span class="inquiry-input btn_att">
                        <a class="layui-btn layui-btn-primary" onclick="AttachmentView(@Model.FItemID.ToString(),'0')">编辑</a>
                    </span>
                </li>
            </ul>

            <ul class="infor-c ">
                <li>
                    @*<span style="float: left; color: red; font-size: 24px; vertical-align: middle;display: block; margin-left: 8px;width: 1px;">*</span>*@
                    <span class="infor-c-width">税务登记证：<span style="color: red; font-size: 24px;vertical-align: middle; margin-left: 8px;width: 4px;">*</span></span>
                    <span class="infor-c-input">
                        @Html.TextBoxFor(m => m.FTaxNum, new { disabled = "disabled" })
                    </span>
                </li>
                <li>
                    <span class="infor-c-width">有效期至：</span>
                    <span class="infor-c-input">
                        <input type="text" name="FTaxDeadLine" value="@(ViewBag.FTaxDeadLine == null ? "":ViewBag.FTaxDeadLine.ToString("D") )" disabled="disabled" />
                    </span>
                </li>
                <li>
                    <span class="infor-c-input btn_att">
                        <a class="layui-btn layui-btn-primary" onclick="AttachmentView(@Model.FItemID.ToString(),'1')">编辑</a>
                    </span>
                </li>
            </ul>

            <ul class="infor-c ">
                <li>
                    <span class="infor-c-width">ISO9001：<span style="color: red; font-size: 24px;vertical-align: middle; margin-left: 8px;width: 4px;">*</span></span>
                    <span class="infor-c-input">
                        @Html.TextBoxFor(m => m.FISO9001)
                    </span>
                </li>
                <li>
                    <span class="infor-c-width">有效期至：</span>
                    <span class="infor-c-input">
                        <input type="text" name="FISO9001DeadLine" value="@(ViewBag.FISO9001DeadLine == null ? "":ViewBag.FISO9001DeadLine.ToString("D") )" disabled="disabled" />
                    </span>
                </li>
                <li>

                    <span class="infor-c-input btn_att">
                        <a class="layui-btn layui-btn-primary" onclick="AttachmentView(@Model.FItemID.ToString(),'2')">编辑</a>
                    </span>
                </li>
            </ul>

            <ul class="infor-c ">
                <li>
                    <span class="infor-c-width">ISO14000：</span>
                    <span class="infor-c-input">
                        @Html.TextBoxFor(m => m.FISO14000)
                    </span>
                </li>
                <li>
                    <span class="infor-c-width">有效期至：</span>
                    <span class="infor-c-input">
                        <input type="text" name="FISO14000DeadLine" value="@(ViewBag.FISO14000DeadLine == null ? "":ViewBag.FISO14000DeadLine.ToString("D") )" disabled="disabled" />
                    </span>
                </li>
                <li>

                    <span class="infor-c-input btn_att">
                        <a class="layui-btn layui-btn-primary" onclick="AttachmentView(@Model.FItemID.ToString(),'3')">编辑</a>
                    </span>
                </li>
            </ul>
            <ul class="infor-c ">
                <li>
                    <span class="infor-c-width">专利证书：</span>
                    <span class="infor-c-input">
                        @Html.TextBoxFor(m => m.FPatent)
                    </span>
                </li>
                <li>
                    <span class="infor-c-width">有效期至：</span>
                    <span class="infor-c-input">
                        <input type="text" name="FPatentDeadLine" value="@(ViewBag.FPatentDeadLine == null ? "":ViewBag.FPatentDeadLine.ToString("D") )" disabled="disabled" />
                    </span>
                </li>
                <li>
                    <span class="infor-c-input btn_att">
                        <a class="layui-btn layui-btn-primary" onclick="AttachmentView(@Model.FItemID.ToString(),'4')">编辑</a>
                    </span>
                </li>
            </ul>
            <ul class="infor-c ">
                <li>
                    <span class="infor-c-width">其他认证：</span>
                    <span class="infor-c-input">
                        @Html.TextBoxFor(m => m.FOther)
                    </span>
                </li>

                <li>
                    <span class="infor-c-width">有效期至：</span>
                    <span class="infor-c-input">
                        <input type="text" name="FOtherDeadLine" value="@(ViewBag.FOtherDeadLine == null ? "":ViewBag.FOtherDeadLine.ToString("D") )" disabled="disabled" />
                    </span>
                </li>
                <li>

                    <span class="infor-c-input btn_att">
                        <a class="layui-btn layui-btn-primary" onclick="AttachmentView(@Model.FItemID.ToString(),'5')">编辑</a>
                    </span>
                </li>
            </ul>
            <ul class="infor-c ">
                <li>
                    <span class="infor-c-width">供应商调查表：</span>
                    <span class="infor-c-input">
                        @Html.TextBoxFor(m => m.FQuestionnaire)
                    </span>
                </li>

                <li>
                    <span class="infor-c-width">有效期至：</span>
                    <span class="infor-c-input">
                        <input type="text" name="FQuestionnaireDeadLine" value="@(ViewBag.FQuestionnaireDeadLine == null ? "":ViewBag.FQuestionnaireDeadLine.ToString("D") )" disabled="disabled" />
                    </span>
                </li>
                <li>

                    <span class="infor-c-input btn_att">
                        <a class="layui-btn layui-btn-primary" onclick="AttachmentView(@Model.FItemID.ToString(),'6')">编辑</a>
                    </span>
                </li>
            </ul>
            <ul class="infor-c" id="agentul">
                <li>
                    <span class="infor-c-width">代理证：<span style="color: red; font-size: 24px;vertical-align: middle; margin-left: 8px;width: 4px;">*</span></span>
                    <span class="infor-c-input">
                        @Html.TextBoxFor(m => m.FAgent)
                    </span>
                </li>

                <li>
                    <span class="infor-c-width">有效期至：</span>
                    <span class="infor-c-input">
                        <input type="text" name="FAgentDeadLine" value="@(ViewBag.FAgentDeadLine == null ? "":ViewBag.FAgentDeadLine.ToString("D") )" disabled="disabled" />
                    </span>
                </li>
                <li>

                    <span class="infor-c-input btn_att">
                        <a class="layui-btn layui-btn-primary" onclick="AttachmentView(@Model.FItemID.ToString(),'7')">编辑</a>
                    </span>
                </li>
            </ul>
        </div>
        <div class="inquiry-input infor-b">
            <span>
                <button onclick="return SaveForm()">保存</button>
            </span><span>
                <button onclick="return RedirectUrl('/NQ_Supplier/List')">返回</button>
            </span>
        </div>
    </div>
}
<script src="~/Scripts/NAjs/NQ_Supplier.js"></script>

<style>
    .btn_att {
        margin-left: 30px;
    }
</style>

<script type="text/javascript">
    $(document).ready(function(){
        var sutype = @Model.FSupplierType;

        if (sutype == 0)
        {
            $('#agentul').hide();
        }
        if (sutype == 1)
        {
            $('#agentul').show();
        }
    });

    //保存表单
    function SaveForm() {
        var FLicenceExist = @ViewBag.FLicenceExist;
        var FTaxNumExist = @ViewBag.FTaxNumExist;
        //var FISO9001Exist = @ViewBag.FISO9001Exist;
        var FISO14000Exist = @ViewBag.FISO14000Exist;
        var FPatentExist = @ViewBag.FPatentExist;
        var FOtherExist = @ViewBag.FOtherExist;
        var FQuestionnaireExist = @ViewBag.FQuestionnaireExist;
        var FAgentExist = @ViewBag.FAgentExist;

        if (FLicenceExist==0)
        {
            $.messager.alert("操作提示", "营业执照必须上传", "warning");
            return false;
        }
        if (FTaxNumExist==0)
        {
            $.messager.alert("操作提示", "税务登记号必须上传", "warning");
            return false;
        }
        //if (FISO9001Exist==0)
        //{
        //    $.messager.alert("操作提示", "ISO9001必须上传", "warning");
        //    return false;
        //}

        var val = $('input:radio[name="FSupplierType"]:checked').val();

        if (val == 1)
        {
            if (FAgentExist==0)
            {
                $.messager.alert("操作提示", "代理证必须上传", "warning");
                return false;
            }
        }

        var fitemid = $("#FItemID").val();

        return submitSupplierForm('/NQ_Supplier/EditPage?id=' + fitemid);
    }

    function submitSupplierForm(RetUrl) {
        //表单验证
        var options = {
            beforeSubmit: function () {
                return true;
            },
            dataType: "json",//这里是指控制器处理后返回的类型，这里返回json格式。  
            success: function (context) {
                if ("success" == context.result) {
                    $.messager.alert("操作提示", '操作成功！', 'info', function () {
                        location.href = RetUrl;
                    });
                }
                if ("Repeat" == context.result) {
                    $.messager.alert("操作提示", '用户名已经存在！', 'Repeat');
                }
                if ("error" == context.result) {
                    $.messager.alert("操作提示", '操作失败！', 'error');
                }
                if ("Nameerror" == context.result) {
                    $.messager.alert("操作提示", '免疫点名称和所属区域不能为空！', 'error');
                }
                if ("MenuNameerror" == context.result) {
                    $.messager.alert("操作提示", '菜单名称和菜单路径不能为空！', 'error');
                }
                if ("Pointerror" == context.result) {
                    $.messager.alert("操作提示", '免疫点坐标不能为空！', 'error');
                }
                if ("error1" == context.result) {
                    $.messager.alert("操作提示", '提交失败！', 'error');
                }
                if ("error2" == context.result) {
                    $.messager.alert("操作提示", '您已经参与过了！', 'error');
                }
                if ("error3" == context.result) {
                    $.messager.alert("操作提示", '提交成功！', 'info', function () {
                        location.href = RetUrl;
                    });
                }
                if ("error4" == context.result) {
                    $.messager.alert("操作提示", '提交失败！', 'error');
                }

                if ("error5" == context.result) {
                    $.messager.alert("操作提示", '调查问卷已经过期！', 'error');
                }

            },
            error: function (XMLHttpRequest, textStatus, errorThrown) {
                $.messager.alert("操作提示", '操作失败！', 'error');
            }
        }
        $('#form1').ajaxSubmit(options);
        return false; //为了不刷新页面,返回false 
    }

</script>
