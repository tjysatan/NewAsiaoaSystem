@{
    Layout = "~/Views/Shared/_SysLayout.cshtml";
}


<style>
    .layui-top-box {
        padding: 40px 20px 20px 20px;
        color: #fff
    }

    .panel {
        margin-bottom: 17px;
        background-color: #fff;
        border: 1px solid transparent;
        border-radius: 3px;
        -webkit-box-shadow: 0 1px 1px rgba(0,0,0,.05);
        box-shadow: 0 1px 1px rgba(0,0,0,.05)
    }

    .panel-body {
        padding: 15px;
        background: none !important;
        color: none !important;
        border-width: initial !important;
        border-style: none !important;
        color: white !important
    }

    .panel-title {
        margin-top: 0;
        margin-bottom: 0;
        font-size: 14px !important;
        color: inherit !important
    }

    .label {
        display: inline;
        padding: .2em .6em .3em;
        font-size: 75%;
        font-weight: 700;
        line-height: 1;
        color: #fff;
        text-align: center;
        white-space: nowrap;
        vertical-align: baseline;
        border-radius: .25em;
        margin-top: .3em;
    }

    .layui-red {
        color: red
    }

    .pull-right {
        float: right
    }

    .main_btn > p {
        height: 40px;
    }

    body {
        margin: 15px 15px 15px 15px !important;
        background: #f2f2f2 !important;
    }

    .layuimini-container {
        border: 1px solid #f2f2f2;
        border-radius: 5px;
        background-color: #ffffff
    }

    .layuimini-main {
        margin: 10px 10px 10px 10px;
    }

    /**必填红点 */
    .layuimini-form > .layui-form-item > .required:after {
        content: '*';
        color: red;
        position: absolute;
        margin-left: 4px;
        font-weight: bold;
        line-height: 1.8em;
        top: 6px;
        right: 5px;
    }

    .layuimini-form > .layui-form-item > .layui-form-label {
        width: 120px !important;
    }

    .layuimini-form > .layui-form-item > .layui-input-block {
        margin-left: 150px !important;
    }

        .layuimini-form > .layui-form-item > .layui-input-block > tip {
            display: inline-block;
            margin-top: 10px;
            line-height: 10px;
            font-size: 10px;
            color: #a29c9c;
        }



    /**搜索框*/
    .layuimini-container .table-search-fieldset {
        margin: 0;
        border: 1px solid #e6e6e6;
        padding: 10px 20px 5px 20px;
        color: #6b6b6b;
    }
</style>

<script>
    var loadi;
    function ddchen() {
        loadi = layer.load(1, { shade: [0.8, '#393D49'] })
    }
    //关闭等待效果
    function disLoading() {
        layer.close(loadi);
    }
    $(function () {
        FB_ordercount();
        DS_ordercount();
        FT_ordercount();
        CP_ordercount();
        Get_TheMonth_DailySales();

    })

    //非标订单
   async function FB_ordercount() {
        $.ajax({
            url: "../DKX_DD/DKX_DD_Statistics_Interface",
            type: "POST",
            dataType: "json",
            async: true,
            beforeSend: function () {
                ddchen();
            },
            success: function (response) {
                disLoading();
                if (response.result == "success") {
                    console.log(response.data);
                    $("#YY_Count").html(response.data.TotalSum);
                    $("#MM_Count").html("本月:"+response.data.TotaSameMonthSum +"条");
                }
                else {
                    console.log(response.msg);
                }
            },
            error: function (e) {
                disLoading();
                layer.alert("操作失败！", { icon: 2 });
            }
        })
    }

    //电商的销售订单
    async function DS_ordercount() {
        $.ajax({
            url: "../NA_XSinfo/DKX_DSOrder_Statistics_Interface",
            type: "POST",
            dataType: "json",
            async: true,
            beforeSend: function () {
                ddchen();
            },
            success: function (response) {
                disLoading();
                if (response.result == "success") {
                    console.log(response.data);
                    $("#DS_YY_Count").html(response.data.TotalSum);
                    $("#DS_MM_Count").html("本月:" + response.data.TotaSameMonthSum + "条");
                }
                else {
                    console.log(response.msg);
                }
            },
            error: function (e) {
                disLoading();
                layer.alert("操作失败！", { icon: 2 });
            }
        })
    }

    //返退货订单
    function FT_ordercount() {
        $.ajax({
            url: "../NAReturnList/DKX_FTOrder_Statistics_Interface",
            type: "POST",
            dataType: "json",
            async: true,
            beforeSend: function () {
                ddchen();
            },
            success: function (response) {
                disLoading();
                if (response.result == "success") {
                    console.log(response.data);
                    $("#FT_YY_Count").html(response.data.TotalSum);
                    $("#FT_MM_Count").html("本月:" + response.data.TotaSameMonthSum + "条");
                }
                else {
                    console.log(response.msg);
                }
            },
            error: function (e) {
                disLoading();
                layer.alert("操作失败！", { icon: 2 });
            }
        })
    }

    //方案库订单
    async function CP_ordercount() {
        $.ajax({
            url: "../DKX_DD/DKX_CP_Statistics_Interface",
            type: "POST",
            dataType: "json",
            async: true,
            beforeSend: function () {
                ddchen();
            },
            success: function (response) {
                disLoading();
                if (response.result == "success") {
                    console.log(response.data);
                    $("#CP_YY_Count").html(response.data.TotalSum);
                    $("#CP_MM_Count").html("本月:" + response.data.TotaSameMonthSum + "条");
                }
                else {
                    console.log(response.msg);
                }
            },
            error: function (e) {
                disLoading();
                layer.alert("操作失败！", { icon: 2 });
            }
        })
    }

    //查询当月每天的销售出货量
    function Get_TheMonth_DailySales() {
        $.ajax({
            url: "../ERPDATA/Get_TheMonth_DailySales_Interface",
            type: "POST",
            dataType: "json",
            async: true,
            beforeSend: function () {
                ddchen();
            },
            success: function (response) {
                disLoading();
                if (response.result == "success") {
                    console.log('11122222',response.data);
                    TJ_BaoBiao(response.data);
                }
                else {
                    console.log(response.msg);
                }
            },
            error: function (e) {
                disLoading();
                layer.alert("操作失败！", { icon: 2 });
            }
        })
    }

    //
    function TJ_BaoBiao(json) {

        console.log('json', json);
        var categoriesDATA = [];
        var data = [];
        for (var i = 0, J = json.length; i < J; i++) {
            categoriesDATA.push(json[i][1]+"日");
            data.push(json[i][0]);
        }

        $('#container').highcharts({
            chart: {
                type: 'spline'
            },
            title: {
                text: 'ERP当月的销售数据'
            },
            subtitle: {
                text: '数据来源: pushisoftERP'
            },
            xAxis: {
                categories: categoriesDATA
            },
            yAxis: {
                title: {
                    text: '销售额'
                },
                labels: {
                    formatter: function () {
                        return this.value + '元';
                    }
                }
            },
            tooltip: {
                crosshairs: true,
                shared: true
            },
            plotOptions: {
                spline: {
                    marker: {
                        radius: 4,
                        lineColor: '#666666',
                        lineWidth: 1
                    }
                }
            },
            series: [{
                name: '销售出货（元）',
                marker: {
                    symbol: 'square'
                },
                data: data
            } ]
        })
    }
</script>
<script src="../Scripts/highcharts.js"></script>
 

<div class="layuimini-container">
    <div class="layuimini-main layui-top-box">
        <div class="layui-row layui-col-space10">

            <div class="layui-col-md3">
                <div class="col-xs-6 col-md-3">
                    <div class="panel layui-bg-cyan">
                        <div class="panel-body" style="">
                            <div class="panel-title">
                                <span class="label pull-right layui-bg-blue">实时</span>
                                <h5>非标订单</h5>
                            </div>
                            <div class="panel-content">
                                 <h1 class="no-margins" id="MM_Count"></h1>
 
                                <small>今年下单</small><span id="YY_Count"></span>条
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="layui-col-md3">
                <div class="col-xs-6 col-md-3">
                    <div class="panel layui-bg-blue">
                        <div class="panel-body">
                            <div class="panel-title">
                                <span class="label pull-right layui-bg-cyan">实时</span>
                                <h5>电商订单</h5>
                            </div>
                            <div class="panel-content">
                                <h1 class="no-margins" id="DS_MM_Count"></h1>

                                <small>今年下单</small><span id="DS_YY_Count"></span>条
                                @*<h1 class="no-margins">1234</h1>*@
                                @*<div class="stat-percent font-bold text-gray"><i class="fa fa-commenting"></i> 1234</div>*@
                                @*<small>当前分类总记录数</small>*@
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="layui-col-md3">
                <div class="col-xs-6 col-md-3">
                    <div class="panel layui-bg-green">
                        <div class="panel-body">
                            <div class="panel-title">
                                <span class="label pull-right layui-bg-orange">实时</span>
                                <h5>返退货</h5>
                            </div>
                            <div class="panel-content">
                                <h1 class="no-margins" id="FT_MM_Count"></h1>

                                <small>今年下单</small><span id="FT_YY_Count"></span>条
                                @*<small>当前分类总记录数</small>*@
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="layui-col-md3">
                <div class="col-xs-6 col-md-3">
                    <div class="panel layui-bg-orange">
                        <div class="panel-body">
                            <div class="panel-title">
                                <span class="label pull-right layui-bg-green">实时</span>
                                <h5>方案库</h5>
                            </div>
                            <div class="panel-content">
                                <h1 class="no-margins" id="CP_MM_Count"></h1>

                                <small>方案库已有</small><span id="CP_YY_Count"></span>条
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
 
    </div>

    <div class="layui-card">
        <div class="layui-card-header">
            <i class="fa fa-line-chart icon"></i>报表统计
        </div>
        <div class="layui-card-body">
            <div id="container" style="width: 100%;min-height:65vh">

            </div>
        </div>
    </div>


</div>